Index: app/src/main/res/layout/activity_main.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<android.support.v4.widget.DrawerLayout\r\n    android:id=\"@+id/drawer_layout\"\r\n    xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n    xmlns:tools=\"http://schemas.android.com/tools\"\r\n    android:layout_width=\"match_parent\"\r\n    android:layout_height=\"match_parent\"\r\n    android:fitsSystemWindows=\"true\"\r\n    tools:context=\"e.a.exlorista_customer.MainActivity\">\r\n\r\n    <RelativeLayout\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"match_parent\">\r\n\r\n        <android.support.v7.widget.Toolbar\r\n            android:id=\"@+id/toolbar\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            xmlns:app=\"http://schemas.android.com/apk/res-auto\"\r\n            android:background=\"@drawable/appbardesign\"\r\n            android:fitsSystemWindows=\"true\">\r\n\r\n        </android.support.v7.widget.Toolbar>\r\n\r\n        <android.support.constraint.ConstraintLayout\r\n            android:id=\"@+id/top_header\"\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"wrap_content\"\r\n            >\r\n\r\n\r\n            <TextView\r\n                android:id=\"@+id/textView3\"\r\n                android:layout_width=\"wrap_content\"\r\n                android:layout_height=\"wrap_content\"\r\n                android:layout_marginTop=\"8dp\"\r\n                android:fontFamily=\"@font/comfortaa_bold\"\r\n                android:text=\"Explorista\"\r\n                android:textColor=\"@color/whiteColor\"\r\n                android:textSize=\"18sp\"\r\n                android:textStyle=\"bold\"\r\n                app:layout_constraintEnd_toEndOf=\"parent\"\r\n                app:layout_constraintStart_toStartOf=\"parent\"\r\n                app:layout_constraintTop_toTopOf=\"parent\" />\r\n\r\n            <ImageView\r\n                android:id=\"@+id/imageView3\"\r\n                android:layout_width=\"75px\"\r\n                android:layout_height=\"75px\"\r\n                android:layout_marginTop=\"8dp\"\r\n                android:layout_marginEnd=\"24dp\"\r\n                android:layout_marginRight=\"24dp\"\r\n                app:layout_constraintBottom_toBottomOf=\"@+id/textView3\"\r\n                app:layout_constraintEnd_toEndOf=\"parent\"\r\n                app:layout_constraintTop_toTopOf=\"@+id/textView3\"\r\n                app:srcCompat=\"@drawable/shopping_cart\"\r\n                tools:ignore=\"VectorDrawableCompat\" />\r\n\r\n        </android.support.constraint.ConstraintLayout>\r\n\r\n\r\n        <android.support.design.widget.CoordinatorLayout\r\n            android:layout_width=\"match_parent\"\r\n            android:layout_height=\"match_parent\"\r\n            android:fitsSystemWindows=\"true\"\r\n            android:layout_below=\"@+id/toolbar\">\r\n\r\n            <android.support.v4.widget.NestedScrollView\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"match_parent\">\r\n\r\n                <android.support.constraint.ConstraintLayout\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"match_parent\">\r\n\r\n                    <android.support.v4.view.ViewPager\r\n                        android:id=\"@+id/imgSliderVP\"\r\n                        android:layout_width=\"match_parent\"\r\n                        android:layout_height=\"150dp\"\r\n                        android:padding=\"5dp\"\r\n                        android:layout_marginTop=\"10dp\"\r\n                        app:layout_constraintEnd_toEndOf=\"parent\"\r\n                        app:layout_constraintStart_toStartOf=\"parent\"\r\n                        app:layout_constraintTop_toTopOf=\"parent\" />\r\n\r\n                    <TextView\r\n                        android:id=\"@+id/nearByStoresTV\"\r\n                        android:layout_width=\"wrap_content\"\r\n                        android:layout_height=\"wrap_content\"\r\n                        android:layout_marginTop=\"10dp\"\r\n                        android:text=\"Nearby Stores\"\r\n                        android:textColor=\"@color/blackColor\"\r\n                        android:fontFamily=\"@font/comfortaa_bold\"\r\n                        android:textSize=\"18sp\"\r\n                        android:textStyle=\"bold\"\r\n                        app:layout_constraintTop_toBottomOf=\"@+id/imgSliderVP\"\r\n                        app:layout_constraintStart_toStartOf=\"parent\"\r\n                        android:layout_marginStart=\"10dp\"\r\n                        android:layout_marginLeft=\"10dp\"/>\r\n\r\n                    <android.support.v7.widget.RecyclerView\r\n                        android:id=\"@+id/storeRV\"\r\n                        android:layout_width=\"match_parent\"\r\n                        android:layout_height=\"0dp\"\r\n                        android:layout_marginTop=\"20dp\"\r\n                        app:layout_constraintTop_toBottomOf=\"@+id/nearByStoresTV\" />\r\n\r\n                    <TextView\r\n                        android:layout_width=\"match_parent\"\r\n                        android:layout_height=\"65dp\"\r\n                        app:layout_constraintTop_toBottomOf=\"@id/storeRV\"\r\n                        android:visibility=\"invisible\"/>\r\n\r\n                </android.support.constraint.ConstraintLayout>\r\n\r\n            </android.support.v4.widget.NestedScrollView>\r\n\r\n            <android.support.v4.widget.NestedScrollView\r\n                android:id=\"@+id/cartSummary_MainActivityNSV\"\r\n                android:layout_width=\"match_parent\"\r\n                android:layout_height=\"65dp\"\r\n                android:clipToPadding=\"true\"\r\n                android:background=\"@color/colorPrimary\"\r\n                app:layout_behavior=\"android.support.design.widget.BottomSheetBehavior\">\r\n\r\n                <LinearLayout\r\n                    android:id=\"@+id/cartSummary_MainActivityLL\"\r\n                    android:orientation=\"horizontal\"\r\n                    android:layout_width=\"match_parent\"\r\n                    android:layout_height=\"match_parent\"\r\n                    android:padding=\"10dp\"\r\n                    android:layout_marginStart=\"10dp\"\r\n                    android:layout_marginLeft=\"10dp\">\r\n                    <TextView\r\n                        android:id=\"@+id/cartItemCount_MainActivityTV\"\r\n                        android:layout_height=\"match_parent\"\r\n                        android:layout_width=\"0dp\"\r\n                        android:layout_weight=\"0.4\"\r\n                        android:textColor=\"@color/whiteColor\"\r\n                        android:textStyle=\"bold\"\r\n                        android:textSize=\"20sp\"\r\n                        android:layout_gravity=\"center_vertical\"\r\n                        android:text=\"1 item\"/>\r\n                    <Button\r\n                        android:id=\"@+id/proceedToCart_MainActivityB\"\r\n                        android:layout_height=\"35dp\"\r\n                        android:layout_width=\"200dp\"\r\n                        android:layout_marginRight=\"2dp\"\r\n                        android:fontFamily=\"@font/comfortaa_bold\"\r\n                        android:background=\"@color/whiteColor\"\r\n                        android:drawableRight=\"@drawable/cart_arrow\"\r\n                        android:text=\"Proceed to cart\"/>\r\n                </LinearLayout>\r\n\r\n            </android.support.v4.widget.NestedScrollView>\r\n\r\n        </android.support.design.widget.CoordinatorLayout>\r\n\r\n\r\n\r\n    </RelativeLayout>\r\n\r\n    <android.support.design.widget.NavigationView\r\n        android:id=\"@+id/nav_view\"\r\n        android:layout_width=\"match_parent\"\r\n        android:layout_height=\"match_parent\"\r\n        android:layout_gravity=\"start\"\r\n        app:menu=\"@menu/drawer_menu\"\r\n        app:itemTextColor=\"@color/blackColor\"\r\n        app:headerLayout=\"@layout/nav_header\"\r\n        />\r\n\r\n</android.support.v4.widget.DrawerLayout>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/res/layout/activity_main.xml	(revision 8b0e573ee0a54db47238a99cb078bb9e0380da09)
+++ app/src/main/res/layout/activity_main.xml	(date 1603274864275)
@@ -17,7 +17,6 @@
             android:id="@+id/toolbar"
             android:layout_width="match_parent"
             android:layout_height="wrap_content"
-            xmlns:app="http://schemas.android.com/apk/res-auto"
             android:background="@drawable/appbardesign"
             android:fitsSystemWindows="true">
 
Index: app/src/main/java/e/a/exlorista_customer/MainActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package e.a.exlorista_customer;\r\n\r\nimport android.app.Application;\r\nimport android.content.Context;\r\nimport android.content.Intent;\r\nimport android.graphics.Bitmap;\r\nimport android.graphics.BitmapFactory;\r\nimport android.graphics.drawable.Drawable;\r\nimport android.net.ConnectivityManager;\r\nimport android.os.AsyncTask;\r\nimport android.os.Handler;\r\nimport android.support.annotation.NonNull;\r\nimport android.support.design.widget.NavigationView;\r\nimport android.support.v4.content.res.ResourcesCompat;\r\nimport android.support.v4.view.GravityCompat;\r\nimport android.support.v4.view.ViewPager;\r\nimport android.support.v4.widget.DrawerLayout;\r\nimport android.support.v4.widget.NestedScrollView;\r\nimport android.support.v7.app.ActionBarDrawerToggle;\r\nimport android.support.v7.app.AppCompatActivity;\r\nimport android.os.Bundle;\r\nimport android.support.v7.widget.LinearLayoutManager;\r\nimport android.support.v7.widget.RecyclerView;\r\nimport android.support.v7.widget.Toolbar;\r\nimport android.util.Log;\r\nimport android.view.Menu;\r\nimport android.view.MenuItem;\r\nimport android.view.View;\r\nimport android.widget.Button;\r\nimport android.widget.ImageView;\r\nimport android.widget.LinearLayout;\r\nimport android.widget.TextView;\r\n\r\nimport org.json.JSONArray;\r\nimport org.json.JSONException;\r\nimport org.json.JSONObject;\r\n\r\nimport java.io.BufferedReader;\r\nimport java.io.IOException;\r\nimport java.io.InputStream;\r\nimport java.io.InputStreamReader;\r\nimport java.net.HttpURLConnection;\r\nimport java.net.MalformedURLException;\r\nimport java.net.SocketTimeoutException;\r\nimport java.net.URL;\r\nimport java.security.acl.Group;\r\nimport java.util.HashMap;\r\nimport java.util.Timer;\r\nimport java.util.TimerTask;\r\n\r\npublic class MainActivity extends AppCompatActivity implements NavigationView.OnNavigationItemSelectedListener{\r\n\r\n    private DrawerLayout drawer;\r\n    private NavigationView navigationView;\r\n    private ViewPager imgSliderVP;\r\n    private ImageSliderAdapter imageSliderAdapter;\r\n    private RecyclerView storeDetailsRV;\r\n    private RecyclerView.Adapter storeDetailsRVAdapter;\r\n    private RecyclerView.LayoutManager storeDetailsRVLayoutManager;\r\n    private int currentPage;\r\n    private Timer timer;\r\n    private ActionBarDrawerToggle toggle;\r\n\r\n    private auxiliary aux;\r\n    private Context mContext;\r\n\r\n    private final int SECONDS_UNTIL_SERVER_UNAVAILABILITY=2;\r\n    private final int SLIDER_DELAY=0;\r\n    private final int SLIDER_PERIOD=10;\r\n    static HashMap<String,Integer> IDHamburgerOption=new HashMap<>();\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_main);\r\n        mContext=this;\r\n        navigationView=findViewById(R.id.nav_view);\r\n        attachOnClickListenersToUserAccountManagementViews();\r\n        currentPage=0;\r\n        aux=new auxiliary();\r\n        aux.setServerAvailability(-1);\r\n\r\n        try{\r\n            if(!aux.isInternetAvailable()){\r\n                // Internet not available. However, if there's internet then data plan must be inactive\r\n                LaunchNoInternetActivity(0);\r\n            }\r\n            else{\r\n                // Internet available with active data plan\r\n                Log.i(\"MainActivity\",\"internet available, checking server availability\");\r\n                aux.checkServerAvailability(auxiliary.SERVER_URL+\"/fetchHamburgerMenu.php\",\r\n                        SECONDS_UNTIL_SERVER_UNAVAILABILITY);\r\n                Log.i(\"MainActivity\",\"checking done, inside while loop\");\r\n                while(true){\r\n                    int serverAvailability=aux.getServerAvailability();\r\n                    if(serverAvailability==1){\r\n                        // server available\r\n                        getHamburgerJSON(auxiliary.SERVER_URL+\"/fetchHamburgerMenu.php\");\r\n                        loadImageSlider(SLIDER_PERIOD,SLIDER_DELAY);\r\n                        loadStoreDetails();\r\n                        //fetchSetImage(auxiliary.SERVER_URL+\"/images/ads/ad1.jpg\");\r\n                        //getGalleryImagesPathJSON(auxiliary.SERVER_URL+\"/fetchGalleryImages.php\");\r\n                        break;\r\n                    }\r\n                    else if(serverAvailability==0){\r\n                        // server unavailable\r\n                        LaunchNoInternetActivity(1);\r\n                        break;\r\n                    }\r\n                }\r\n                Log.i(\"MainActivity\",\"out of while loop\");\r\n                Log.i(\"MainActivity server url\", auxiliary.SERVER_URL);\r\n            }\r\n        }\r\n        catch (InterruptedException ie){\r\n            //Log.i(\"ERROR\", \"InterruptedException occurred\");\r\n            //ie.printStackTrace();\r\n        }\r\n        catch (IOException io){\r\n            //Log.i(\"ERROR\", \"IOException occurred\");\r\n            //io.printStackTrace();\r\n        }\r\n\r\n        //navigationView=findViewById(R.id.nav_view);\r\n        /*navigationView.setNavigationItemSelectedListener(this);\r\n        Toolbar toolbar=findViewById(R.id.toolbar);\r\n        setSupportActionBar(toolbar);\r\n        drawer=findViewById(R.id.drawer_layout);\r\n\r\n        ActionBarDrawerToggle toggle=new ActionBarDrawerToggle(this, drawer, toolbar,\r\n                R.string.navigation_drawer_open,R.string.navigation_drawer_close);\r\n        drawer.addDrawerListener(toggle);\r\n        toggle.syncState();*/\r\n\r\n        //Navigation Drawer\r\n        setUpToolbar();\r\n        //Navigation Drawer Close\r\n\r\n\r\n    }\r\n\r\n    //Navigtion Drawer\r\n\r\n    private void setUpToolbar() {\r\n        drawer = findViewById(R.id.drawer_layout);\r\n        Toolbar toolbar = findViewById(R.id.toolbar);\r\n        setSupportActionBar(toolbar);\r\n\r\n        toggle = new ActionBarDrawerToggle(this, drawer, toolbar, R.string.navigation_drawer_open, R.string.navigation_drawer_close);\r\n        drawer.addDrawerListener(toggle);\r\n        toggle.syncState();\r\n        getSupportActionBar().setDisplayShowTitleEnabled(false);\r\n        Drawable d = ResourcesCompat.getDrawable(getResources(), R.drawable.menu, null);\r\n        toolbar.setNavigationIcon(d);\r\n\r\n\r\n    }\r\n    //Navigation Drawer Close\r\n\r\n    @Override\r\n    protected void onResume() {\r\n        Log.i(\"Inside onResume\",\"Code executed\");\r\n        manageUserDetailInNavbar();\r\n        handleBottomSheetBehavior();\r\n        super.onResume();\r\n    }\r\n\r\n    @Override\r\n    public boolean onNavigationItemSelected(@NonNull MenuItem item) {\r\n\r\n        if(item.getItemId()==IDHamburgerOption.get(\"cart\")){\r\n            startActivity(new Intent(this,cart.class));\r\n            drawer.closeDrawer(GravityCompat.START);\r\n        }\r\n        else if(item.getItemId()==IDHamburgerOption.get(\"order history\")){\r\n            startActivity(new Intent(this,orderHistory.class));\r\n            drawer.closeDrawer(GravityCompat.START);\r\n        }\r\n        else if(item.getItemId()==IDHamburgerOption.get(\"address book\")){\r\n            startActivity(new Intent(this,addressBook.class));\r\n            drawer.closeDrawer(GravityCompat.START);\r\n        }\r\n        else if(item.getItemId()==IDHamburgerOption.get(\"payment methods\")){\r\n            startActivity(new Intent(this,paymentMethods.class));\r\n            drawer.closeDrawer(GravityCompat.START);\r\n        }\r\n        else if(item.getItemId()==IDHamburgerOption.get(\"wallet\")){\r\n            startActivity(new Intent(this,wallet.class));\r\n            drawer.closeDrawer(GravityCompat.START);\r\n        }\r\n        else if(item.getItemId()==IDHamburgerOption.get(\"bookmarked stores\")){\r\n            startActivity(new Intent(this,bookmarkedStores.class));\r\n            drawer.closeDrawer(GravityCompat.START);\r\n        }\r\n        else if(item.getItemId()==IDHamburgerOption.get(\"help and support\")){\r\n            startActivity(new Intent(this,helpAndSupport.class));\r\n            drawer.closeDrawer(GravityCompat.START);\r\n        }\r\n        else if(item.getItemId()==IDHamburgerOption.get(\"about us\")){\r\n            startActivity(new Intent(this,aboutUs.class));\r\n            drawer.closeDrawer(GravityCompat.START);\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n\r\n    private void getHamburgerJSON(final String urlWebService) {\r\n\r\n        class GetHamburgerJSON extends AsyncTask<Void, Void, String> {\r\n\r\n            @Override\r\n            protected void onPostExecute(String s) {\r\n                super.onPostExecute(s);\r\n                NavigationView navView = findViewById(R.id.nav_view);\r\n                Menu menu = navView.getMenu();\r\n                try {\r\n                    //Log.i(\"json\", s);\r\n                    JSONArray jsonArray = new JSONArray(s);\r\n                    int hamburgerOptionID = Menu.FIRST;\r\n                    for (int i = 0; i < jsonArray.length(); i++) {\r\n                        JSONObject obj = jsonArray.getJSONObject(i);\r\n                        String optionName = obj.getString(\"option name\");\r\n                        menu.add(R.id.hamburger_menu, hamburgerOptionID, 0, optionName)\r\n                                .setVisible(obj.getInt(\"visibility\") == 1);\r\n                        IDHamburgerOption.put(optionName, hamburgerOptionID);\r\n                        //Log.i(optionName, Integer.toString(hamburgerOptionID));\r\n                        hamburgerOptionID++;\r\n                    }\r\n                    navView.invalidate();\r\n                } catch (JSONException e) {\r\n                    //Log.i(\"exception\",\"JSONException occurred in GetJSON\");\r\n                    //e.printStackTrace();\r\n                } catch (NullPointerException ne) {\r\n                    //App has internet connection\r\n                    //but is unable to establish connection to database server.\r\n                    //Programmatically string 's' will be null and as a result,\r\n                    //NullPointerException will occur\r\n                    //Log.i(\"exception\", \"NullPointerException occurred in GetJSON\");\r\n                    //ne.printStackTrace();\r\n                }\r\n            }\r\n\r\n            @Override\r\n            protected String doInBackground(Void... voids) {\r\n                try {\r\n                    URL url = new URL(urlWebService);\r\n                    HttpURLConnection con = (HttpURLConnection) url.openConnection();\r\n                    StringBuilder sb = new StringBuilder();\r\n                    String json;\r\n                    BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(con.getInputStream()));\r\n                    while ((json = bufferedReader.readLine()) != null) {\r\n                        sb.append(json);\r\n                    }\r\n                    return sb.toString().trim();\r\n                } catch (MalformedURLException mue){\r\n                    //Log.i(\"exception\",\"MalformedURLException occurred in GetJSON\");\r\n                } catch (IOException io){\r\n                    //Log.i(\"exception\",\"IOException occurred in GetJSON\");\r\n                } catch (Exception e){\r\n                    //Log.i(\"exception\",\"Exception occurred in GetJSON\");\r\n                }\r\n                return null;\r\n            }\r\n        }\r\n        GetHamburgerJSON getHamburgerJSON=new GetHamburgerJSON();\r\n        getHamburgerJSON.execute();\r\n    }\r\n\r\n    private void getGalleryImagesPathJSON(final String urlWebService){\r\n        class GetGalleryImagesPathJSON extends AsyncTask<Void, Void, String>{\r\n\r\n            @Override\r\n            protected void onPostExecute(String s) {\r\n                super.onPostExecute(s);\r\n                try {\r\n                    //Log.i(\"json\", s);\r\n                    JSONArray jsonArray = new JSONArray(s);\r\n                    for (int i = 0; i < jsonArray.length(); i++) {\r\n                        JSONObject obj = jsonArray.getJSONObject(i);\r\n                        String storeId = obj.getString(\"store_id\");\r\n                        String adspaceId = obj.getString(\"adspace_id\");\r\n                        String dirPath = obj.getString(\"dirpath_path\");\r\n                        String fileExt = obj.getString(\"fileext_name\");\r\n                        //Log.i(\"IMAGE PATH\",dirPath+storeId+\"_\"+adspaceId+\".\"+fileExt);\r\n                    }\r\n                } catch (JSONException e) {\r\n                    //Log.i(\"exception\",\"JSONException occurred in GetGalleryImagesPathJSON\");\r\n                    //e.printStackTrace();\r\n                } catch (NullPointerException ne) {\r\n                    //Log.i(\"exception\", \"NullPointerException occurred in GetGalleryImagesPathJSON\");\r\n                    //ne.printStackTrace();\r\n                }\r\n            }\r\n\r\n            @Override\r\n            protected String doInBackground(Void... voids) {\r\n                try {\r\n                    URL url = new URL(urlWebService);\r\n                    HttpURLConnection con = (HttpURLConnection) url.openConnection();\r\n                    StringBuilder sb = new StringBuilder();\r\n                    String json;\r\n                    BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(con.getInputStream()));\r\n                    while ((json = bufferedReader.readLine()) != null) {\r\n                        sb.append(json);\r\n                    }\r\n                    return sb.toString().trim();\r\n                } catch (MalformedURLException mue){\r\n                    //Log.i(\"exception\",\"MalformedURLException occurred in GetGalleryImagesPathJSON\");\r\n                } catch (IOException io){\r\n                    //Log.i(\"exception\",\"IOException occurred in GetGalleryImagesPathJSON\");\r\n                } catch (Exception e){\r\n                    //Log.i(\"exception\",\"Exception occurred in GetGalleryImagesPathJSON\");\r\n                }\r\n                return null;\r\n            }\r\n        }\r\n        GetGalleryImagesPathJSON getGalleryImagesPathJSON=new GetGalleryImagesPathJSON();\r\n        getGalleryImagesPathJSON.execute();\r\n    }\r\n\r\n    /*\r\n    private void fetchSetImage(final String imageUrl){\r\n        class FetchSetImage extends AsyncTask<Void, Void, Bitmap> {\r\n            @Override\r\n            protected Bitmap doInBackground(Void... voids) {\r\n                try {\r\n                    URL url = new URL(imageUrl);\r\n                    HttpURLConnection connection = (HttpURLConnection) url.openConnection();\r\n                    connection.setDoInput(true);\r\n                    connection.connect();\r\n                    InputStream input = connection.getInputStream();\r\n                    return BitmapFactory.decodeStream(input);\r\n                } catch (MalformedURLException mue){\r\n                    Log.i(\"exception\",\"MalformedURLException occurred in fetchsetImage\");\r\n                } catch (Exception e){\r\n                    Log.i(\"exception\",\"Exception occurred in fetchsetImage\");\r\n                    e.printStackTrace();\r\n                }\r\n                return null;\r\n            }\r\n\r\n            @Override\r\n            protected void onPostExecute(Bitmap result) {\r\n                if(result!=null) {\r\n                    ImageView imageView = findViewById(R.id.testIV);\r\n                    imageView.setScaleType(ImageView.ScaleType.CENTER_CROP);\r\n                    imageView.setImageBitmap(result);\r\n                }\r\n                else{\r\n                    Log.i(\"bitmap NULL\",\"bitmap is null\");\r\n                }\r\n            }\r\n        }\r\n        FetchSetImage fetchSetImage=new FetchSetImage();\r\n        fetchSetImage.execute();\r\n    }\r\n    */\r\n\r\n\r\n    @Override\r\n    public void onBackPressed() {\r\n        if(drawer.isDrawerOpen(GravityCompat.START)){\r\n            drawer.closeDrawer(GravityCompat.START);\r\n        }else {\r\n            super.onBackPressed();\r\n        }\r\n    }\r\n\r\n    private void LaunchNoInternetActivity(int internetStatusCode){\r\n        Intent intent=new Intent(this,NoInternet.class);\r\n        intent.putExtra(auxiliary.INTERNET_STATUS_STRING,internetStatusCode);\r\n        intent.putExtra(auxiliary.CALLING_ACTIVITY_NAME,this.getClass().getSimpleName());\r\n        intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TASK);\r\n        intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);\r\n        startActivity(intent);\r\n    }\r\n\r\n    private void loadImageSlider(int slider_period, int slider_delay){\r\n        imgSliderVP=findViewById(R.id.imgSliderVP);\r\n        imageSliderAdapter=new ImageSliderAdapter(this);\r\n        imgSliderVP.setAdapter(imageSliderAdapter);\r\n        final int slideCount=imageSliderAdapter.getCount();\r\n        final Handler handler=new Handler();\r\n        final Runnable updateImage=new Runnable() {\r\n            @Override\r\n            public void run() {\r\n                if(currentPage==slideCount){\r\n                    currentPage=0;\r\n                }\r\n                imgSliderVP.setCurrentItem(currentPage++,true);\r\n            }\r\n        };\r\n        timer=new Timer();\r\n        timer.schedule(new TimerTask() {\r\n            @Override\r\n            public void run() {\r\n                handler.post(updateImage);\r\n            }\r\n        }, slider_delay*1000, slider_period*1000);\r\n    }\r\n\r\n    private void loadStoreDetails(){\r\n        storeDetailsRV=findViewById(R.id.storeRV);\r\n        storeDetailsRVLayoutManager=new LinearLayoutManager(this, LinearLayoutManager.VERTICAL,false);\r\n        storeDetailsRVAdapter=new StoreDetailsAdapter(this);\r\n        storeDetailsRV.setLayoutManager(storeDetailsRVLayoutManager);\r\n        storeDetailsRV.setAdapter(storeDetailsRVAdapter);\r\n    }\r\n\r\n    private void addUserDetailToNavbar(String email,String display_name,String phone){\r\n        LinearLayout navBarUserDetailsLL;\r\n        TextView navBarUserDisplayNameTV,navBarUserEmailTV,navBarUserPhoneTV;\r\n        Button navLoginB,navSignupB,navSignoutB;\r\n\r\n        View header=navigationView.getHeaderView(0);\r\n        navBarUserDetailsLL=header.findViewById(R.id.navBarUserDetailsLL);\r\n        navBarUserDisplayNameTV=header.findViewById(R.id.navBarUserDisplayNameTV);\r\n        navBarUserEmailTV=header.findViewById(R.id.navBarUserEmailTV);\r\n        navBarUserPhoneTV=header.findViewById(R.id.navBarUserPhoneTV);\r\n        navLoginB=header.findViewById(R.id.navLoginB);\r\n        navSignupB=header.findViewById(R.id.navSignupB);\r\n        navSignoutB=header.findViewById(R.id.navSignoutB);\r\n\r\n        navLoginB.setVisibility(View.GONE);\r\n        navSignupB.setVisibility(View.GONE);\r\n        navBarUserDisplayNameTV.setText(display_name);\r\n        navBarUserEmailTV.setText(email);\r\n        navBarUserPhoneTV.setText(phone);\r\n        navBarUserDetailsLL.setVisibility(View.VISIBLE);\r\n        navSignoutB.setVisibility(View.VISIBLE);\r\n    }\r\n\r\n    void clearUserDetailFromNavbar(){\r\n        LinearLayout navBarUserDetailsLL;\r\n        Button navLoginB,navSignupB,navSignoutB;\r\n\r\n        View header=navigationView.getHeaderView(0);\r\n        navBarUserDetailsLL=header.findViewById(R.id.navBarUserDetailsLL);\r\n        navLoginB=header.findViewById(R.id.navLoginB);\r\n        navSignupB=header.findViewById(R.id.navSignupB);\r\n        navSignoutB=header.findViewById(R.id.navSignoutB);\r\n\r\n        navBarUserDetailsLL.setVisibility(View.GONE);\r\n        navSignoutB.setVisibility(View.GONE);\r\n        navLoginB.setVisibility(View.VISIBLE);\r\n        navSignupB.setVisibility(View.VISIBLE);\r\n    }\r\n\r\n    void manageUserDetailInNavbar(){\r\n        HashMap<String,String> userDetails_HM=auxiliaryuseraccountmanager.getUserDetailsFromSP(mContext);\r\n        if(userDetails_HM.get(auxiliaryuseraccountmanager.DETAILTYPE_USERDATAVALIDITYFLAG)!=null){\r\n            if(userDetails_HM\r\n                    .get(auxiliaryuseraccountmanager.DETAILTYPE_USERDATAVALIDITYFLAG)\r\n                    .equals(auxiliaryuseraccountmanager.USERDATA_VALID)){\r\n                addUserDetailToNavbar(\r\n                        userDetails_HM.get(auxiliaryuseraccountmanager.DETAILTYPE_EMAIL),\r\n                        userDetails_HM.get(auxiliaryuseraccountmanager.DETAILTYPE_DISPLAYNAME),\r\n                        userDetails_HM.get(auxiliaryuseraccountmanager.DETAILTYPE_PHONENUMBER));\r\n            } else if(userDetails_HM\r\n                    .get(auxiliaryuseraccountmanager.DETAILTYPE_USERDATAVALIDITYFLAG)\r\n                    .equals(auxiliaryuseraccountmanager.USERDATA_INVALID)){\r\n                clearUserDetailFromNavbar();\r\n            }\r\n        }\r\n    }\r\n\r\n    void attachOnClickListenersToUserAccountManagementViews(){\r\n        View header=navigationView.getHeaderView(0);\r\n        Button navLoginB=header.findViewById(R.id.navLoginB);\r\n        Button navSignupB=header.findViewById(R.id.navSignupB);\r\n        Button navSignoutB=header.findViewById(R.id.navSignoutB);\r\n        navLoginB.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                Intent MainActivityToLoginOrSignupIntent=new Intent(MainActivity.this,loginOrSignup.class);\r\n                MainActivityToLoginOrSignupIntent.putExtra(auxiliary.NAVBUTTON_CLICKED,auxiliary.NAV_LOGINB);\r\n                startActivity(MainActivityToLoginOrSignupIntent);\r\n            }\r\n        });\r\n        navSignupB.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                Intent MainActivityToLoginOrSignupIntent=new Intent(MainActivity.this,loginOrSignup.class);\r\n                MainActivityToLoginOrSignupIntent.putExtra(auxiliary.NAVBUTTON_CLICKED,auxiliary.NAV_SIGNUPB);\r\n                startActivity(MainActivityToLoginOrSignupIntent);\r\n            }\r\n        });\r\n        navSignoutB.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                clearUserDetailFromNavbar();\r\n                auxiliaryuseraccountmanager.signOutOGC(mContext,getString(R.string.default_web_client_id),false);\r\n            }\r\n        });\r\n    }\r\n\r\n    void handleBottomSheetBehavior(){\r\n        NestedScrollView cartSummary_MainActivityNSV=findViewById(R.id.cartSummary_MainActivityNSV);\r\n        TextView cartItemCount_MainActivityTV=findViewById(R.id.cartItemCount_MainActivityTV);\r\n        Button proceedToCart_MainActivityB=findViewById(R.id.proceedToCart_MainActivityB);\r\n        try{\r\n            int cartItemCount=auxiliarycart.diffProdCountInCart(mContext);\r\n            if(cartItemCount>0){\r\n                cartSummary_MainActivityNSV.setVisibility(View.VISIBLE);\r\n                cartItemCount_MainActivityTV.setText(Integer.toString(cartItemCount)+\" items\");\r\n                if(!proceedToCart_MainActivityB.hasOnClickListeners()){\r\n                    proceedToCart_MainActivityB.setOnClickListener(new View.OnClickListener() {\r\n                        @Override\r\n                        public void onClick(View view) {\r\n                            Intent MainActivityToCartIntent=new Intent(MainActivity.this,cart.class);\r\n                            startActivity(MainActivityToCartIntent);\r\n                        }\r\n                    });\r\n                }\r\n            } else{\r\n                cartSummary_MainActivityNSV.setVisibility(View.GONE);\r\n            }\r\n        } catch (Exception e){\r\n            cartSummary_MainActivityNSV.setVisibility(View.GONE);\r\n        }\r\n    }\r\n\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/e/a/exlorista_customer/MainActivity.java	(revision 8b0e573ee0a54db47238a99cb078bb9e0380da09)
+++ app/src/main/java/e/a/exlorista_customer/MainActivity.java	(date 1603276126820)
@@ -144,6 +144,8 @@
     private void setUpToolbar() {
         drawer = findViewById(R.id.drawer_layout);
         Toolbar toolbar = findViewById(R.id.toolbar);
+        navigationView=findViewById(R.id.nav_view);
+        navigationView.setNavigationItemSelectedListener(this);
         setSupportActionBar(toolbar);
 
         toggle = new ActionBarDrawerToggle(this, drawer, toolbar, R.string.navigation_drawer_open, R.string.navigation_drawer_close);
Index: app/src/main/java/e/a/exlorista_customer/signinorup.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package e.a.exlorista_customer;\r\n\r\nimport android.content.Context;\r\nimport android.content.Intent;\r\nimport android.support.annotation.NonNull;\r\nimport android.support.v7.app.AppCompatActivity;\r\nimport android.os.Bundle;\r\nimport android.util.Log;\r\nimport android.view.View;\r\nimport android.widget.Button;\r\nimport android.widget.EditText;\r\nimport android.widget.TextView;\r\nimport android.widget.Toast;\r\n\r\nimport com.facebook.AccessToken;\r\nimport com.facebook.CallbackManager;\r\nimport com.facebook.FacebookAuthorizationException;\r\nimport com.facebook.FacebookCallback;\r\nimport com.facebook.FacebookException;\r\nimport com.facebook.FacebookSdk;\r\nimport com.facebook.appevents.AppEventsLogger;\r\nimport com.facebook.login.LoginBehavior;\r\nimport com.facebook.login.LoginManager;\r\nimport com.facebook.login.LoginResult;\r\nimport com.facebook.login.widget.LoginButton;\r\nimport com.google.android.gms.auth.api.signin.GoogleSignIn;\r\nimport com.google.android.gms.auth.api.signin.GoogleSignInAccount;\r\nimport com.google.android.gms.auth.api.signin.GoogleSignInClient;\r\nimport com.google.android.gms.auth.api.signin.GoogleSignInOptions;\r\nimport com.google.android.gms.common.SignInButton;\r\nimport com.google.android.gms.common.api.ApiException;\r\nimport com.google.android.gms.tasks.OnCompleteListener;\r\nimport com.google.android.gms.tasks.Task;\r\nimport com.google.firebase.auth.AuthCredential;\r\nimport com.google.firebase.auth.AuthResult;\r\nimport com.google.firebase.auth.FacebookAuthProvider;\r\nimport com.google.firebase.auth.FirebaseAuth;\r\nimport com.google.firebase.auth.FirebaseUser;\r\nimport com.google.firebase.auth.GoogleAuthProvider;\r\n\r\nimport org.w3c.dom.Text;\r\n\r\npublic class signinorup extends AppCompatActivity {\r\n    // TO BE DELETED\r\n\r\n    EditText phoneNoET;\r\n    Button phoneLoginB;\r\n    SignInButton signInGoogleSIB;\r\n    LoginButton signInFacebookLB;\r\n    CallbackManager callbackManager;\r\n    //Context mContext;\r\n    FirebaseAuth mAuth;\r\n    GoogleSignInClient mGoogleSignInClient;\r\n    private CallbackManager mCallbackManager;\r\n\r\n    private final Context mContext=this;\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_signinorup);\r\n        getSupportActionBar().hide();\r\n        //mContext=this;\r\n        mCallbackManager=CallbackManager.Factory.create();\r\n        auxiliaryuseraccountmanager.LoggedInWith loggedInWith=userSignedIn();\r\n\r\n        if(loggedInWith!=null){\r\n            Intent signinorupToPaymentIntent=new Intent(signinorup.this,payment.class);\r\n            startActivity(signinorupToPaymentIntent);\r\n            finish();\r\n        }\r\n\r\n        phoneNoET=findViewById(R.id.phoneNoET);\r\n        phoneLoginB=findViewById(R.id.phoneLoginB);\r\n        signInGoogleSIB=findViewById(R.id.signInGoogleSIB);\r\n        signInFacebookLB=findViewById(R.id.signInFacebookLB);\r\n        signInFacebookLB.setReadPermissions(\"email\",\"public_profile\");\r\n        signInFacebookLB.setLoginBehavior(LoginBehavior.WEB_VIEW_ONLY);\r\n        signInFacebookLB.registerCallback(mCallbackManager, new FacebookCallback<LoginResult>() {\r\n            @Override\r\n            public void onSuccess(LoginResult loginResult) {\r\n                handleFacebookAccessToken(loginResult.getAccessToken());\r\n            }\r\n\r\n            @Override\r\n            public void onCancel() {\r\n                // change ui\r\n            }\r\n\r\n            @Override\r\n            public void onError(FacebookException e) {\r\n                Toast.makeText(mContext,\"onError\",Toast.LENGTH_LONG).show();\r\n                // change ui\r\n            }\r\n        });\r\n\r\n        GoogleSignInOptions gso=new GoogleSignInOptions.Builder(GoogleSignInOptions.DEFAULT_SIGN_IN)\r\n                .requestIdToken(getString(R.string.default_web_client_id))\r\n                .requestEmail()\r\n                .build();\r\n        mGoogleSignInClient=GoogleSignIn.getClient(mContext,gso);\r\n        mAuth=FirebaseAuth.getInstance();\r\n        signInGoogleSIB.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                signInGoogle();\r\n            }\r\n        });\r\n        phoneLoginB.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                String phoneNoEntered=phoneNoET.getText().toString().trim();\r\n                if(phoneNoEntered.length()==10){\r\n                    Intent signinorupTophoneVerificationIntent=new Intent(signinorup.this,phoneVerification.class);\r\n                    signinorupTophoneVerificationIntent.putExtra(auxiliary.PHONE_NO,\"+91\"+phoneNoEntered);\r\n                    phoneNoET.setText(\"\");\r\n                    startActivity(signinorupTophoneVerificationIntent);\r\n                    finish();\r\n                } else{\r\n                    phoneNoET.setError(\"Valid number is required\");\r\n                    phoneNoET.requestFocus();\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    @Override\r\n    protected void onActivityResult(int requestCode, int resultCode, Intent data) {\r\n        super.onActivityResult(requestCode, resultCode, data);\r\n        mCallbackManager.onActivityResult(requestCode, resultCode, data);\r\n        // Result returned from launching the Intent from GoogleSignInApi.getSignInIntent(...);\r\n        if (requestCode == auxiliaryuseraccountmanager.RC_SIGN_IN) {\r\n            Task<GoogleSignInAccount> task = GoogleSignIn.getSignedInAccountFromIntent(data);\r\n            try {\r\n                // Google Sign In was successful, authenticate with Firebase\r\n                GoogleSignInAccount account = task.getResult(ApiException.class);\r\n                firebaseAuthWithGoogle(account.getIdToken());\r\n            } catch (ApiException apie) {\r\n                // Google Sign In failed, update UI appropriately\r\n                Toast.makeText(mContext,\"Sign in failed (ApiException)\",Toast.LENGTH_LONG).show();\r\n            } catch (NullPointerException npe){\r\n                // Google Sign In failed, due to account being null\r\n                Toast.makeText(mContext,\"Sign in failed (NullPointerException)\",Toast.LENGTH_LONG).show();\r\n            } catch (Exception e){\r\n                // Google Sign In failed, due to some unknown error\r\n                Toast.makeText(mContext,\"Sign in failed (Exception)\",Toast.LENGTH_LONG).show();\r\n                e.printStackTrace();\r\n            }\r\n        } else {\r\n            // requestCode != RC_SIGN_IN i.e., 9001\r\n            Toast.makeText(mContext,\"request code not 9001\",Toast.LENGTH_LONG).show();\r\n        }\r\n    }\r\n\r\n    private auxiliaryuseraccountmanager.LoggedInWith userSignedIn(){\r\n        /* check if user is logged in any way\r\n        either through Google, Facebook, or Phone.\r\n        If user logged in -> return corresponding member of enum LoggedInWith\r\n        else -> return null\r\n        */\r\n        // 1) Check for Firebase (i.e., user is signed in either with Phone or Google)\r\n        FirebaseUser user=FirebaseAuth.getInstance().getCurrentUser();\r\n        if(user!=null){\r\n            return auxiliaryuseraccountmanager.LoggedInWith.GOOGLE;\r\n        }\r\n        // 2) Check for Facebook (i.e., user is signed in with Facebook)\r\n        AccessToken accessToken = AccessToken.getCurrentAccessToken();\r\n        if(accessToken != null && !accessToken.isExpired()){\r\n            return auxiliaryuseraccountmanager.LoggedInWith.FACEBOOK;\r\n        }\r\n        return null;\r\n    }\r\n\r\n    private void signInGoogle() {\r\n        Intent signInIntent = mGoogleSignInClient.getSignInIntent();\r\n        startActivityForResult(signInIntent, auxiliaryuseraccountmanager.RC_SIGN_IN);\r\n    }\r\n\r\n    private void signOut(auxiliaryuseraccountmanager.LoggedInWith loggedInWith) {\r\n        // Firebase sign out\r\n        mAuth.signOut();\r\n\r\n        if(loggedInWith==auxiliaryuseraccountmanager.LoggedInWith.GOOGLE){\r\n            // Google sign out\r\n            mGoogleSignInClient.signOut().addOnCompleteListener(this,\r\n                    new OnCompleteListener<Void>() {\r\n                        @Override\r\n                        public void onComplete(@NonNull Task<Void> task) {\r\n                        }\r\n                    });\r\n        }\r\n        else if(loggedInWith==auxiliaryuseraccountmanager.LoggedInWith.FACEBOOK){\r\n            // Facebook sign out\r\n            LoginManager.getInstance().logOut();\r\n        }\r\n    }\r\n\r\n    private void firebaseAuthWithGoogle(String idToken) {\r\n        AuthCredential credential = GoogleAuthProvider.getCredential(idToken, null);\r\n        mAuth.signInWithCredential(credential)\r\n                .addOnCompleteListener(this, new OnCompleteListener<AuthResult>() {\r\n                    @Override\r\n                    public void onComplete(@NonNull Task<AuthResult> task) {\r\n                        if (task.isSuccessful()) {\r\n                            // Sign in success, update UI with the signed-in user's information\r\n                            FirebaseUser user = mAuth.getCurrentUser();\r\n                            //auxiliaryuseraccountmanager.saveUserGoogleSignInClientToSP(mContext,mGoogleSignInClient);\r\n                            Intent signinorupToPaymentIntent=new Intent(signinorup.this,payment.class);\r\n                            startActivity(signinorupToPaymentIntent);\r\n                            finish();\r\n                        } else {\r\n                            // If sign in fails, display a message to the user.\r\n                            Toast.makeText(mContext,\"sign in failed\",Toast.LENGTH_LONG).show();\r\n                        }\r\n                    }\r\n                });\r\n    }\r\n\r\n    private void handleFacebookAccessToken(AccessToken token) {\r\n        AuthCredential credential = FacebookAuthProvider.getCredential(token.getToken());\r\n        mAuth.signInWithCredential(credential)\r\n                .addOnCompleteListener(this, new OnCompleteListener<AuthResult>() {\r\n                    @Override\r\n                    public void onComplete(@NonNull Task<AuthResult> task) {\r\n                        if (task.isSuccessful()) {\r\n                            // Sign in success, update UI with the signed-in user's information\r\n                            Intent signinorupToPaymentIntent=new Intent(signinorup.this,payment.class);\r\n                            startActivity(signinorupToPaymentIntent);\r\n                            finish();\r\n                        } else {\r\n                            // If sign in fails, display a message to the user.\r\n                            Toast.makeText(mContext,\"sign in failed\",Toast.LENGTH_LONG).show();\r\n                        }\r\n                    }\r\n                });\r\n    }\r\n\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/e/a/exlorista_customer/signinorup.java	(revision 8b0e573ee0a54db47238a99cb078bb9e0380da09)
+++ app/src/main/java/e/a/exlorista_customer/signinorup.java	(date 1603275592176)
@@ -59,7 +59,7 @@
     protected void onCreate(Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);
         setContentView(R.layout.activity_signinorup);
-        getSupportActionBar().hide();
+      //  getSupportActionBar().hide();
         //mContext=this;
         mCallbackManager=CallbackManager.Factory.create();
         auxiliaryuseraccountmanager.LoggedInWith loggedInWith=userSignedIn();
Index: app/src/main/java/e/a/exlorista_customer/loginOrSignup.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package e.a.exlorista_customer;\r\n\r\nimport android.content.Context;\r\nimport android.content.Intent;\r\nimport android.content.res.ColorStateList;\r\nimport android.graphics.Typeface;\r\nimport android.os.AsyncTask;\r\nimport android.support.annotation.NonNull;\r\nimport android.support.v4.content.ContextCompat;\r\nimport android.support.v7.app.AppCompatActivity;\r\nimport android.os.Bundle;\r\nimport android.util.Log;\r\nimport android.view.View;\r\nimport android.widget.Button;\r\nimport android.widget.EditText;\r\nimport android.widget.LinearLayout;\r\nimport android.widget.TextView;\r\nimport android.widget.Toast;\r\n\r\nimport com.facebook.AccessToken;\r\nimport com.facebook.CallbackManager;\r\nimport com.facebook.FacebookCallback;\r\nimport com.facebook.FacebookException;\r\nimport com.facebook.Profile;\r\nimport com.facebook.login.LoginBehavior;\r\nimport com.facebook.login.LoginResult;\r\nimport com.facebook.login.widget.LoginButton;\r\nimport com.google.android.gms.auth.api.signin.GoogleSignIn;\r\nimport com.google.android.gms.auth.api.signin.GoogleSignInAccount;\r\nimport com.google.android.gms.auth.api.signin.GoogleSignInClient;\r\nimport com.google.android.gms.auth.api.signin.GoogleSignInOptions;\r\nimport com.google.android.gms.common.SignInButton;\r\nimport com.google.android.gms.common.api.ApiException;\r\nimport com.google.android.gms.tasks.OnCompleteListener;\r\nimport com.google.android.gms.tasks.Task;\r\nimport com.google.firebase.auth.AuthCredential;\r\nimport com.google.firebase.auth.AuthResult;\r\nimport com.google.firebase.auth.FacebookAuthProvider;\r\nimport com.google.firebase.auth.FirebaseAuth;\r\nimport com.google.firebase.auth.FirebaseUser;\r\nimport com.google.firebase.auth.GoogleAuthProvider;\r\n\r\nimport org.json.JSONArray;\r\nimport org.json.JSONObject;\r\n\r\nimport java.io.BufferedReader;\r\nimport java.io.DataOutputStream;\r\nimport java.io.InputStreamReader;\r\nimport java.net.HttpURLConnection;\r\nimport java.net.URL;\r\nimport java.util.HashMap;\r\nimport java.util.concurrent.ExecutionException;\r\n\r\npublic class loginOrSignup extends AppCompatActivity {\r\n\r\n    SignInButton signInGoogleNewwSIB;\r\n    LoginButton signInFacebookNewwLB;\r\n    TextView loginTV,signupTV,orNewwTV;\r\n    EditText phoneNoNewwET;\r\n    LinearLayout continueWithGoogleLL, continueWithFacebookLL, phoneLoginNewwLL;\r\n    Button phoneLoginNewwB;\r\n\r\n    FirebaseAuth mAuth;\r\n    GoogleSignInClient mGoogleSignInClient;\r\n    CallbackManager mCallbackManager;\r\n\r\n    private final Context mContext=this;\r\n    //private enum options{LOGIN,SIGNUP};\r\n    private auxiliaryuseraccountmanager.options selectedOption;\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_login_or_signup);\r\n        getSupportActionBar().hide();\r\n\r\n        auxiliaryuseraccountmanager.LoggedInWith loggedInWith=auxiliaryuseraccountmanager.userSignedIn(mContext);\r\n        String signInStatus=auxiliaryuseraccountmanager.getSignInStatus(mContext);\r\n        if(signInStatus!=null){\r\n            if(loggedInWith!=null){\r\n                switch (signInStatus){\r\n                    case auxiliaryuseraccountmanager.INVALID_SIGNIN:\r\n                        auxiliaryuseraccountmanager.signOutOGC(mContext,getString(R.string.default_web_client_id),false);\r\n                        break;\r\n                    case auxiliaryuseraccountmanager.VALID_SIGNIN:\r\n                        proceedToPaymentActivity();\r\n                        break;\r\n                }\r\n            } else{\r\n                auxiliaryuseraccountmanager.signOutOGC(mContext,getString(R.string.default_web_client_id),false);\r\n            }\r\n            /*\r\n            if(loggedInWith!=null && signInStatus.equals(auxiliaryuseraccountmanager.VALID_SIGNIN)){\r\n                Intent loginOrSignupToPaymentIntent=new Intent(loginOrSignup.this,payment.class);\r\n                startActivity(loginOrSignupToPaymentIntent);\r\n                finish();\r\n            }*/\r\n        } else{\r\n            Log.i(\"AUTH\",\"signInStatus was null. User was logged out.\");\r\n            auxiliaryuseraccountmanager.signOutOGC(mContext,getString(R.string.default_web_client_id),false);\r\n        }\r\n\r\n        loginTV=findViewById(R.id.loginTV);\r\n        signupTV=findViewById(R.id.signupTV);\r\n        orNewwTV=findViewById(R.id.orNewwTV);\r\n        phoneNoNewwET=findViewById(R.id.phoneNoNewwET);\r\n        continueWithGoogleLL=findViewById(R.id.continueWithGoogleLL);\r\n        continueWithFacebookLL=findViewById(R.id.continueWithFacebookLL);\r\n        phoneLoginNewwLL=findViewById(R.id.phoneLoginNewwLL);\r\n        phoneLoginNewwB=findViewById(R.id.phoneLoginNewwB);\r\n        signInGoogleNewwSIB=findViewById(R.id.signInGoogleNewwSIB);\r\n        signInFacebookNewwLB=findViewById(R.id.signInFacebookNewwLB);\r\n\r\n        selectedOption=auxiliaryuseraccountmanager.options.LOGIN;\r\n        loginTV.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                selectedOption=auxiliaryuseraccountmanager.options.LOGIN;\r\n                loginTV.setBackgroundColor(getResources().getColor(R.color.colorActionBarBackground));\r\n                loginTV.setTextColor(getResources().getColor(R.color.colorActionBarTitleText));\r\n                loginTV.setTextSize(18);\r\n                signupTV.setBackgroundColor(getResources().getColor(R.color.colorTransparent));\r\n                signupTV.setTextColor(getResources().getColor(R.color.colorProductBrand));\r\n                signupTV.setTextSize(14);\r\n                orNewwTV.setVisibility(View.VISIBLE);\r\n                phoneLoginNewwLL.setVisibility(View.VISIBLE);\r\n            }\r\n        });\r\n        signupTV.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                selectedOption=auxiliaryuseraccountmanager.options.SIGNUP;\r\n                signupTV.setBackgroundColor(getResources().getColor(R.color.colorActionBarBackground));\r\n                signupTV.setTextColor(getResources().getColor(R.color.colorActionBarTitleText));\r\n                signupTV.setTextSize(18);\r\n                loginTV.setBackgroundColor(getResources().getColor(R.color.colorTransparent));\r\n                loginTV.setTextColor(getResources().getColor(R.color.colorProductBrand));\r\n                loginTV.setTextSize(14);\r\n                orNewwTV.setVisibility(View.GONE);\r\n                phoneLoginNewwLL.setVisibility(View.GONE);\r\n            }\r\n        });\r\n\r\n        try{\r\n            Bundle extras=getIntent().getExtras();\r\n            if(extras!=null){\r\n                if(extras.containsKey(auxiliary.NAVBUTTON_CLICKED)){\r\n                    String navButton_clicked=extras.getString(auxiliary.NAVBUTTON_CLICKED);\r\n                    switch (navButton_clicked){\r\n                        case auxiliary.NAV_LOGINB:\r\n                            loginTV.performClick();\r\n                            break;\r\n                        case auxiliary.NAV_SIGNUPB:\r\n                            signupTV.performClick();\r\n                            break;\r\n                    }\r\n                }\r\n            }\r\n        } catch (NullPointerException ignored){\r\n        } catch (Exception ignored){\r\n        }\r\n\r\n        mAuth=FirebaseAuth.getInstance();\r\n        GoogleSignInOptions gso=new GoogleSignInOptions.Builder(GoogleSignInOptions.DEFAULT_SIGN_IN)\r\n                .requestIdToken(getString(R.string.default_web_client_id))\r\n                .requestEmail()\r\n                .build();\r\n        mGoogleSignInClient=GoogleSignIn.getClient(mContext,gso);\r\n        signInGoogleNewwSIB.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                signInGoogle();\r\n            }\r\n        });\r\n        continueWithGoogleLL.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                //signInGoogleNewwSIB.performClick(); //This somehow does not work\r\n                signInGoogle();\r\n            }\r\n        });\r\n\r\n        mCallbackManager=CallbackManager.Factory.create();\r\n        signInFacebookNewwLB.setReadPermissions(\"email\",\"public_profile\");\r\n        signInFacebookNewwLB.setLoginBehavior(LoginBehavior.WEB_VIEW_ONLY);\r\n        signInFacebookNewwLB.registerCallback(mCallbackManager, new FacebookCallback<LoginResult>() {\r\n            @Override\r\n            public void onSuccess(LoginResult loginResult) {\r\n                handleFacebookAccessToken(loginResult.getAccessToken());\r\n            }\r\n\r\n            @Override\r\n            public void onCancel() {\r\n                // change ui\r\n            }\r\n\r\n            @Override\r\n            public void onError(FacebookException e) {\r\n                Toast.makeText(mContext,\"onError\",Toast.LENGTH_LONG).show();\r\n                // change ui\r\n            }\r\n        });\r\n        continueWithFacebookLL.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                signInFacebookNewwLB.performClick();\r\n            }\r\n        });\r\n        phoneLoginNewwB.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View view) {\r\n                String phoneNoEntered=phoneNoNewwET.getText().toString().trim();\r\n                if(phoneNoEntered.length()==10){\r\n                    if(auxiliaryuseraccountmanager.userExistsInDb(auxiliary.SERVER_URL+\"/userManagement.php\"\r\n                            ,null\r\n                            ,null\r\n                            ,phoneNoEntered\r\n                            ,null)){\r\n                        Intent loginOrSignupToPhoneVerificationIntent=new Intent(loginOrSignup.this,phoneVerification.class);\r\n                        loginOrSignupToPhoneVerificationIntent.putExtra(auxiliary.PHONE_NO,\"+91\"+phoneNoEntered);\r\n                        loginOrSignupToPhoneVerificationIntent.putExtra(auxiliary.SELECTED_OPTION, auxiliaryuseraccountmanager.options.LOGIN);\r\n                        phoneNoNewwET.setText(\"\");\r\n                        startActivity(loginOrSignupToPhoneVerificationIntent);\r\n                        finish();\r\n                    } else{\r\n                        Toast.makeText(mContext,R.string.phone_does_not_exist,Toast.LENGTH_LONG).show();\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    private void signInGoogle() {\r\n        Intent signInIntent = mGoogleSignInClient.getSignInIntent();\r\n        startActivityForResult(signInIntent, auxiliaryuseraccountmanager.RC_SIGN_IN);\r\n    }\r\n\r\n    private void handleFacebookAccessToken(final AccessToken token) {\r\n        AuthCredential credential = FacebookAuthProvider.getCredential(token.getToken());\r\n        mAuth.signInWithCredential(credential)\r\n                .addOnCompleteListener(this, new OnCompleteListener<AuthResult>() {\r\n                    @Override\r\n                    public void onComplete(@NonNull Task<AuthResult> task) {\r\n                        if (task.isSuccessful()) {\r\n                            Log.i(\"FB uid\",token.getUserId());\r\n                            // Sign in success, update UI with the signed-in user's information\r\n                            takeRelevantAction(auxiliaryuseraccountmanager.LoggedInWith.FACEBOOK);\r\n                            //proceedToPaymentActivity();\r\n                        } else {\r\n                            // If sign in fails, display a message to the user.\r\n                            Toast.makeText(mContext,\"sign in failed\",Toast.LENGTH_LONG).show();\r\n                        }\r\n                    }\r\n                });\r\n    }\r\n\r\n    @Override\r\n    protected void onActivityResult(int requestCode, int resultCode, Intent data) {\r\n        super.onActivityResult(requestCode, resultCode, data);\r\n        // For Facebook\r\n        mCallbackManager.onActivityResult(requestCode, resultCode, data);\r\n\r\n        // For Google\r\n        if (requestCode == auxiliaryuseraccountmanager.RC_SIGN_IN) {\r\n            Task<GoogleSignInAccount> task = GoogleSignIn.getSignedInAccountFromIntent(data);\r\n            try {\r\n                // Google Sign In was successful, authenticate with Firebase\r\n                GoogleSignInAccount account = task.getResult(ApiException.class);\r\n                firebaseAuthWithGoogle(account.getIdToken());\r\n            } catch (ApiException apie) {\r\n                // Google Sign In failed, update UI appropriately\r\n                Toast.makeText(mContext,\"Sign in failed (ApiException)\",Toast.LENGTH_LONG).show();\r\n            } catch (NullPointerException npe){\r\n                // Google Sign In failed, due to account being null\r\n                Toast.makeText(mContext,\"Sign in failed (NullPointerException)\",Toast.LENGTH_LONG).show();\r\n            } catch (Exception e){\r\n                // Google Sign In failed, due to some unknown error\r\n                Toast.makeText(mContext,\"Sign in failed (Exception)\",Toast.LENGTH_LONG).show();\r\n                e.printStackTrace();\r\n            }\r\n        } else {\r\n            // requestCode != RC_SIGN_IN i.e., 9001\r\n            Toast.makeText(mContext,\"request code not 9001\",Toast.LENGTH_LONG).show();\r\n        }\r\n    }\r\n\r\n    private void firebaseAuthWithGoogle(String idToken) {\r\n        AuthCredential credential = GoogleAuthProvider.getCredential(idToken, null);\r\n        mAuth.signInWithCredential(credential)\r\n                .addOnCompleteListener(this, new OnCompleteListener<AuthResult>() {\r\n                    @Override\r\n                    public void onComplete(@NonNull Task<AuthResult> task) {\r\n                        if (task.isSuccessful()) {\r\n                            // Sign in success, update UI with the signed-in user's information\r\n                            FirebaseUser user = mAuth.getCurrentUser();\r\n                            takeRelevantAction(auxiliaryuseraccountmanager.LoggedInWith.GOOGLE);\r\n                            //proceedToPaymentActivity();\r\n                        } else {\r\n                            // If sign in fails, display a message to the user.\r\n                            Toast.makeText(mContext,\"sign in failed\",Toast.LENGTH_LONG).show();\r\n                        }\r\n                    }\r\n                });\r\n    }\r\n\r\n    private void takeRelevantAction(auxiliaryuseraccountmanager.LoggedInWith continueWith){\r\n        FirebaseUser user=mAuth.getCurrentUser();\r\n        /* Because phone no cannot be fetched at this moment and will be null\r\n        String userPhoneNumber=user.getPhoneNumber();\r\n        if(userPhoneNumber!=null){\r\n            if(!userPhoneNumber.equals(\"\")){\r\n                if(userPhoneNumber.startsWith(\"+91\")){\r\n                    userPhoneNumber=userPhoneNumber.substring(3);\r\n                }\r\n            }\r\n        }*/\r\n        switch (selectedOption){\r\n            case LOGIN:\r\n                // Remaining : Adding user details (email, displayName, phone) to shared prefs\r\n                //             if user exists in db\r\n                switch (continueWith){\r\n                    case PHONE:\r\n                        if(auxiliaryuseraccountmanager.userExistsInDb(auxiliary.SERVER_URL+\"/userManagement.php\"\r\n                                ,null\r\n                                ,null\r\n                                ,null/*userPhoneNumber*/\r\n                                ,null)){\r\n                        }\r\n                    case GOOGLE:\r\n                        if(auxiliaryuseraccountmanager.userExistsInDb(auxiliary.SERVER_URL+\"/userManagement.php\"\r\n                                ,user.getEmail()\r\n                                ,user.getDisplayName()\r\n                                ,null/*userPhoneNumber*/\r\n                                ,null)){\r\n                            // INCOMPLETE : get user's phone number' from database by user's email\r\n                            // as here userPhoneNumber will be null (Google login)\r\n                            //Log.i(\"AUTH\",\"Inside if\");\r\n                            HashMap<String,String> userDetailInDb=auxiliaryuseraccountmanager.fetchUserDetailFromDb(\r\n                                    auxiliary.SERVER_URL+\"/userManagement.php\"\r\n                                    ,auxiliary.PPK_EMAIL\r\n                                    ,user.getEmail());\r\n                            auxiliaryuseraccountmanager.addUserDetailsToSP(mContext,\r\n                                    userDetailInDb.get(auxiliaryuseraccountmanager.DETAILTYPE_CUSTID),\r\n                                    userDetailInDb.get(auxiliaryuseraccountmanager.DETAILTYPE_EMAIL),\r\n                                    userDetailInDb.get(auxiliaryuseraccountmanager.DETAILTYPE_DISPLAYNAME),\r\n                                    userDetailInDb.get(auxiliaryuseraccountmanager.DETAILTYPE_PHONENUMBER));\r\n                            //Log.i(\"AUTH\",\"fetched phone : \"+((userPhoneNumber==null||userPhoneNumber.equals(\"\"))?\"\":userPhoneNumber));\r\n                            auxiliaryuseraccountmanager.setSignInStatus(mContext,auxiliaryuseraccountmanager.VALID_SIGNIN);\r\n                            proceedToPaymentActivity();\r\n                        } else{\r\n                            //Log.i(\"AUTH\",\"Inside else\");\r\n                            proceedToPhoneVerificationActivity(auxiliaryuseraccountmanager.options.SIGNUP/*because user does not exist\r\n                            in database and will have to signup*/\r\n                                    ,user.getEmail()\r\n                                    ,user.getDisplayName()\r\n                                    ,null/*userPhoneNumber*/\r\n                                    ,null);\r\n                        }\r\n                        break;\r\n                    case FACEBOOK:\r\n                        if(auxiliaryuseraccountmanager.userExistsInDb(auxiliary.SERVER_URL+\"/userManagement.php\"\r\n                                ,user.getEmail()\r\n                                ,user.getDisplayName()\r\n                                ,null/*userPhoneNumber*/\r\n                                ,auxiliaryuseraccountmanager.getFacebookUserId())){\r\n                            HashMap<String,String> userDetailInDb=auxiliaryuseraccountmanager.fetchUserDetailFromDb(\r\n                                    auxiliary.SERVER_URL+\"/userManagement.php\"\r\n                                    ,auxiliary.PPK_FACEBOOKUSERID\r\n                                    ,auxiliaryuseraccountmanager.getFacebookUserId());\r\n                            auxiliaryuseraccountmanager.addUserDetailsToSP(mContext,\r\n                                    userDetailInDb.get(auxiliaryuseraccountmanager.DETAILTYPE_CUSTID),\r\n                                    userDetailInDb.get(auxiliaryuseraccountmanager.DETAILTYPE_EMAIL),\r\n                                    userDetailInDb.get(auxiliaryuseraccountmanager.DETAILTYPE_DISPLAYNAME),\r\n                                    userDetailInDb.get(auxiliaryuseraccountmanager.DETAILTYPE_PHONENUMBER));\r\n                            auxiliaryuseraccountmanager.setSignInStatus(mContext,auxiliaryuseraccountmanager.VALID_SIGNIN);\r\n                            proceedToPaymentActivity();\r\n                        } else{\r\n                            proceedToPhoneVerificationActivity(auxiliaryuseraccountmanager.options.SIGNUP/*because user does not exist\r\n                            in database and will have to signup*/\r\n                                    ,user.getEmail()\r\n                                    ,user.getDisplayName()\r\n                                    ,null/*userPhoneNumber*/\r\n                                    ,auxiliaryuseraccountmanager.getFacebookUserId());\r\n                        }\r\n                        break;\r\n                }\r\n                break;\r\n            case SIGNUP:\r\n                switch (continueWith){\r\n                    case GOOGLE:\r\n                        if(auxiliaryuseraccountmanager.userExistsInDb(auxiliary.SERVER_URL+\"/userManagement.php\"\r\n                                ,user.getEmail()\r\n                                ,user.getDisplayName()\r\n                                ,null/*userPhoneNumber*/\r\n                                ,null)){\r\n                            auxiliaryuseraccountmanager.signOutOGC(mContext,getString(R.string.default_web_client_id),false);\r\n                            Toast.makeText(mContext,getString(R.string.account_already_exists),Toast.LENGTH_LONG).show();\r\n                        } else{\r\n                            proceedToPhoneVerificationActivity(auxiliaryuseraccountmanager.options.SIGNUP\r\n                                    ,user.getEmail()\r\n                                    ,user.getDisplayName()\r\n                                    ,null/*userPhoneNumber*/\r\n                                    ,null);\r\n                        }\r\n                        break;\r\n                    case FACEBOOK:\r\n                        if(auxiliaryuseraccountmanager.userExistsInDb(auxiliary.SERVER_URL+\"/userManagement.php\"\r\n                                ,user.getEmail()\r\n                                ,user.getDisplayName()\r\n                                ,null/*userPhoneNumber*/\r\n                                ,Profile.getCurrentProfile().getId())){\r\n                            auxiliaryuseraccountmanager.signOutOGC(mContext,getString(R.string.default_web_client_id),false);\r\n                            Toast.makeText(mContext,getString(R.string.account_already_exists),Toast.LENGTH_LONG).show();\r\n                        } else{\r\n                            proceedToPhoneVerificationActivity(auxiliaryuseraccountmanager.options.SIGNUP\r\n                                    ,user.getEmail()\r\n                                    ,user.getDisplayName()\r\n                                    ,null/*userPhoneNumber*/\r\n                                    ,auxiliaryuseraccountmanager.getFacebookUserId());\r\n                        }\r\n                        break;\r\n                }\r\n                break;\r\n        }\r\n    }\r\n\r\n    private void proceedToPaymentActivity(){\r\n        Intent loginOrSignupToPaymentIntent=new Intent(loginOrSignup.this,payment.class);\r\n        startActivity(loginOrSignupToPaymentIntent);\r\n        finish();\r\n    }\r\n\r\n    private void proceedToPhoneVerificationActivity(auxiliaryuseraccountmanager.options option,\r\n                                                    String email,\r\n                                                    String displayName,\r\n                                                    String phone,\r\n                                                    String facebookUserId){\r\n        Intent loginOrSignupToPhoneVerificationIntent=new Intent(loginOrSignup.this,phoneVerification.class);\r\n        loginOrSignupToPhoneVerificationIntent.putExtra(auxiliary.SELECTED_OPTION,option);\r\n        loginOrSignupToPhoneVerificationIntent.putExtra(auxiliaryuseraccountmanager.DETAILTYPE_EMAIL,email);\r\n        loginOrSignupToPhoneVerificationIntent.putExtra(auxiliaryuseraccountmanager.DETAILTYPE_DISPLAYNAME,displayName);\r\n        loginOrSignupToPhoneVerificationIntent.putExtra(auxiliaryuseraccountmanager.DETAILTYPE_PHONENUMBER,phone);\r\n        loginOrSignupToPhoneVerificationIntent.putExtra(auxiliaryuseraccountmanager.DETAILTYPE_FACEBOOKUSERID,facebookUserId);\r\n        startActivity(loginOrSignupToPhoneVerificationIntent);\r\n        finish();\r\n    }\r\n\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/e/a/exlorista_customer/loginOrSignup.java	(revision 8b0e573ee0a54db47238a99cb078bb9e0380da09)
+++ app/src/main/java/e/a/exlorista_customer/loginOrSignup.java	(date 1603275592232)
@@ -72,7 +72,7 @@
     protected void onCreate(Bundle savedInstanceState) {
         super.onCreate(savedInstanceState);
         setContentView(R.layout.activity_login_or_signup);
-        getSupportActionBar().hide();
+        //getSupportActionBar().hide();
 
         auxiliaryuseraccountmanager.LoggedInWith loggedInWith=auxiliaryuseraccountmanager.userSignedIn(mContext);
         String signInStatus=auxiliaryuseraccountmanager.getSignInStatus(mContext);
